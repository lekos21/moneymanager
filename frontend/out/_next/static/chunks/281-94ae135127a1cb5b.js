"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[281],{1373:function(e,t,a){a.d(t,{Z:function(){return u}});var s=a(7294);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=o(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:o="",children:l,iconNode:d,...u},x)=>(0,s.createElement)("svg",{ref:x,...c,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:n("lucide",o),...!l&&!i(u)&&{"aria-hidden":"true"},...u},[...d.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(l)?l:[l]])),u=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...o},i)=>(0,s.createElement)(d,{ref:i,iconNode:t,className:n(`lucide-${r(l(e))}`,`lucide-${e}`,a),...o}));return a.displayName=l(e),a}},9281:function(e,t,a){a.d(t,{ZP:function(){return p},jK:function(){return h}});var s=a(5893),r=a(7294),o=a(1373);let l=(0,o.Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),n=(0,o.Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),i=(0,o.Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var c=a(3071),d=a(4682),u=a(9108),x=a(8086);let g={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CAD:"C$",AUD:"A$",CHF:"Fr",CNY:"\xa5",INR:"₹",BRL:"R$"},h=e=>g[e]||e;var p=e=>{var t,a;let{expense:o,messageId:g,onDelete:p,fullWidth:m=!1}=e,{getTag:v}=(0,x.e0)(),[y,f]=(0,r.useState)(!1),w=null;o.tag_id?w=v(o.tag_id):o.area_tags&&o.area_tags.length>0?w=v(o.area_tags[0].toLowerCase()):o.tag&&(w=o.tag);let b=(null==w?void 0:w.icon)||"tag",N=(null==w?void 0:null===(t=w.colors)||void 0===t?void 0:t.hex)||"#6b7280",k=(null==w?void 0:null===(a=w.colors)||void 0===a?void 0:a.hex)||"#d1d5db",j=async()=>{if(!o.id){console.error("No expense ID found:",o);return}let e=!1;try{await d.Z.deleteExpense(o.id),e=!0}catch(e){console.warn("Expense deletion skipped or failed:",e)}if(g)try{await u.Z.deleteMessage(g)}catch(e){console.error("Failed to delete message:",e),alert("Failed to delete message. Please try again."),f(!1);return}p(e?o.id:null,g),f(!1)};return(0,s.jsxs)("div",{className:"rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-shadow bg-white ".concat(m?"w-full":"w-full min-w-[320px] max-w-[400px]"," border-2 border-l-4"),style:{borderLeftColor:k},children:[(0,s.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 border-b-2 border-gray-100 gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-7 h-7 rounded-full flex items-center justify-center mr-2",children:(0,s.jsx)(c.Z,{iconName:b,iconColor:N,className:"text-gray-700",fallbackIcon:"tag"})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1 max-w-[200px]",children:[(0,s.jsx)("h4",{className:"text-base font-semibold text-gray-800 truncate overflow-hidden text-ellipsis",title:o.short_text||"Expense",children:o.short_text||"Expense"}),(0,s.jsxs)("span",{className:"flex items-center text-xs text-gray-500 space-x-1",children:[(0,s.jsx)("span",{children:new Date(o.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("span",{children:new Date(o.timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})})]})]})]}),(0,s.jsxs)("div",{className:"font-bold whitespace-nowrap flex-shrink-0",children:[h(o.currency),parseFloat(o.amount).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"px-3 py-2 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[o.area_tags&&o.area_tags.map(e=>{var t,a,r;let o=v(e.toLowerCase()),l=(null==o?void 0:null===(t=o.colors)||void 0===t?void 0:t.bgHex)||"#EBF5FF",n=(null==o?void 0:null===(a=o.colors)||void 0===a?void 0:a.textHex)||"#3B82F6";return null==o||null===(r=o.colors)||void 0===r||r.hex,null==o||o.icon,(0,s.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{backgroundColor:l,color:n},children:e},"area-".concat(e))}),o.context_tags&&o.context_tags.map(e=>{var t,a,r;let o=v(e.toLowerCase()),l=(null==o?void 0:null===(t=o.colors)||void 0===t?void 0:t.bgHex)||"#F0F7FF",n=(null==o?void 0:null===(a=o.colors)||void 0===a?void 0:a.textHex)||"#2563EB";return null==o||null===(r=o.colors)||void 0===r||r.hex,null==o||o.icon,(0,s.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{backgroundColor:l,color:n},children:e},"context-".concat(e))})]}),y?(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("button",{onClick:()=>f(!1),className:"p-1 text-xs text-gray-600 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",children:(0,s.jsx)(l,{className:"w-3 h-3"})}),(0,s.jsx)("button",{onClick:j,className:"p-1 text-xs text-white rounded-full hover:opacity-90 transition-opacity",style:{background:"linear-gradient(45deg, #E74C3C, #cf8ef9)"},children:(0,s.jsx)(n,{className:"w-3 h-3"})})]}):(0,s.jsx)("button",{onClick:()=>f(!0),className:"text-gray-400 hover:text-gray-600 transition-colors p-1",children:(0,s.jsx)(i,{className:"w-4 h-4"})})]})]})}},3071:function(e,t,a){var s=a(5893),r=a(7294),o=a(2062);t.Z=r.memo(e=>{let{iconName:t,iconColor:a,size:r=24,className:l="",fallbackIcon:n="tag",style:i={}}=e,c={color:a,...i};return(0,s.jsx)(o.Z,{iconName:t||n,size:r,className:l,defaultIcon:n,style:c})},(e,t)=>e.iconName===t.iconName&&e.iconColor===t.iconColor&&e.size===t.size&&e.className===t.className&&e.fallbackIcon===t.fallbackIcon&&JSON.stringify(e.style)===JSON.stringify(t.style))},9108:function(e,t,a){var s=a(7066),r=a(8346);let o="https://moneymanager-backend-qwbwl7ldoa-oa.a.run.app";console.log("Using API URL:",o);let l=async()=>{let e=(0,r.v0)(),t=e.currentUser;if(!t)throw Error("User not authenticated");return await t.getIdToken()},n=async()=>{let e=await l();return s.Z.create({baseURL:o,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})};t.Z={getAuthToken:l,async getMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let t=await n(),a="/api/chat/messages?limit=".concat(e);console.log("Fetching messages from:",a);let s=await t.get(a);return console.log("Messages fetched successfully"),s.data}catch(e){var t;return console.error("Error fetching messages:",e),console.error("Response details:",null===(t=e.response)||void 0===t?void 0:t.data),console.log("Returning fallback messages"),[{id:"fallback-1",content:"Welcome to Money Manager! The message service is currently experiencing issues. Your previous messages will appear when service is restored.",user_id:"system",timestamp:new Date().toISOString(),message_type:"system"}]}},async sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{let a=await n(),s=await a.post("/api/chat/messages",{content:e,message_type:t});return s.data}catch(e){throw console.error("Error sending message:",e),e}},async deleteMessage(e){try{let t=await n();return await t.delete("/api/chat/messages/".concat(e)),!0}catch(e){throw console.error("Error deleting message:",e),e}},async parseExpense(e){try{let t=await n();console.log("Sending expense parser request:",{text:e,save_to_db:!0});let a=await t.post("/api/agents/expense_parser/",{text:e,save_to_db:!0});return console.log("Expense parser response:",a.data),a.data}catch(e){var t;throw console.error("Error parsing expense:",e),console.error("Error details:",null===(t=e.response)||void 0===t?void 0:t.data),e}}}}}]);