(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{8442:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports",function(){return a(2738)}])},5658:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var n=a(5893),r=a(2332),s=a.n(r);function l(){return(0,n.jsxs)("div",{style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},className:"jsx-6e91c5b2b63165c2 flex justify-center items-center h-8 space-x-2 py-2 px-3 rounded-3xl shadow-md relative",children:[[void 0,void 0,void 0].map((e,t)=>(0,n.jsx)("div",{style:{opacity:.8,transform:"translateZ(0)",animation:"wave 0.8s ease-in-out ".concat(.1*t,"s infinite alternate")},className:"jsx-6e91c5b2b63165c2 w-2 h-2 rounded-full bg-white"},t)),(0,n.jsx)(s(),{id:"6e91c5b2b63165c2",children:"@-webkit-keyframes wave{0%{-webkit-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-webkit-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}@-moz-keyframes wave{0%{-moz-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-moz-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}@-o-keyframes wave{0%{-o-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-o-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}@keyframes wave{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-webkit-transform:translatey(-5px);-moz-transform:translatey(-5px);-o-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}"})]})}a(7294)},2738:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var n=a(5893),r=a(7294),s=a(9008),l=a.n(s),o=a(5493),i=a(2537),c=a(558),d=a(1373);let m=(0,d.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var h=e=>{let{onDateRangeChange:t}=e,[a,s]=(0,r.useState)(!1),[l,o]=(0,r.useState)("thisMonth"),[i,c]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),u=[{id:"today",label:"Today"},{id:"thisWeek",label:"This Week"},{id:"thisMonth",label:"This Month"},{id:"lastMonth",label:"Last Month"},{id:"last3Months",label:"Last 3 Months"},{id:"thisYear",label:"This Year"},{id:"custom",label:"Custom Range"}],x=e=>{let t,a;let n=new Date;switch(e){case"today":t=new Date(n),a=new Date(n);break;case"thisWeek":(t=new Date(n)).setDate(n.getDate()-n.getDay()),a=new Date(n);break;case"thisMonth":default:t=new Date(n.getFullYear(),n.getMonth(),1),a=new Date(n);break;case"lastMonth":t=new Date(n.getFullYear(),n.getMonth()-1,1),a=new Date(n.getFullYear(),n.getMonth(),0);break;case"last3Months":t=new Date(n.getFullYear(),n.getMonth()-3,1),a=new Date(n);break;case"thisYear":t=new Date(n.getFullYear(),0,1),a=new Date(n);break;case"custom":t=i?new Date(i):null,a=d?new Date(d):null}return{startDate:t,endDate:a}},g=e=>e?e.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}):"",p=e=>{o(e),s(!1);let{startDate:a,endDate:n}=x(e);t({startDate:a,endDate:n,rangeId:e})};return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{onClick:()=>s(!a),className:"flex items-center justify-between w-full px-4 py-2 bg-white rounded-xl shadow-sm border border-gray-100 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(m,{className:"w-4 h-4 mr-2 text-gray-500"}),(0,n.jsx)("span",{className:"text-gray-700 font-medium",children:(()=>{if("custom"===l&&i&&d)return"".concat(g(new Date(i))," - ").concat(g(new Date(d)));let e=u.find(e=>e.id===l);return e?e.label:"This Month"})()})]}),(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-500 transition-transform ".concat(a?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),a&&(0,n.jsxs)("div",{className:"absolute z-10 mt-2 w-full bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,n.jsx)("div",{className:"p-2",children:u.map(e=>(0,n.jsx)("button",{onClick:()=>p(e.id),className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ".concat(l===e.id?"bg-gradient-to-r from-blue-400 to-purple-500 text-white":"text-gray-700 hover:bg-gray-100"),children:e.label},e.id))}),"custom"===l&&(0,n.jsxs)("div",{className:"p-3 border-t border-gray-100",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Start Date"}),(0,n.jsx)("input",{type:"date",value:i,onChange:e=>c(e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-200 rounded-lg"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"End Date"}),(0,n.jsx)("input",{type:"date",value:d,onChange:e=>h(e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-200 rounded-lg"})]})]}),(0,n.jsx)("button",{onClick:()=>{if(i&&d){let{startDate:e,endDate:a}=x("custom");t({startDate:e,endDate:a,rangeId:"custom"}),s(!1)}},disabled:!i||!d,className:"w-full py-2 text-sm rounded-lg text-center ".concat(i&&d?"bg-gradient-to-r from-blue-400 to-purple-500 text-white":"bg-gray-100 text-gray-400"),children:"Apply Custom Range"})]})]})]})},u=a(6219),x=a(5658),g=a(2062),p=a(6006),y=r.memo(e=>{let{tagId:t,facet:a="area",size:s=24,className:l="",fallbackIcon:o="tag",iconCache:i={},setIconCache:c=()=>{}}=e,[d,m]=(0,r.useState)(null),[h,u]=(0,r.useState)(!0);if((0,r.useEffect)(()=>{let e=async()=>{if(!t){u(!1);return}let e="".concat(a,"-").concat(t);if(i[e]){m(i[e]),u(!1);return}try{let n=await p.Z.getTag(t,a);m(n),c(t=>({...t,[e]:n}))}catch(r){let n={tag_id:t,name:t.charAt(0).toUpperCase()+t.slice(1),facet:a,icon:o};m(n),c(t=>({...t,[e]:n})),console.error("Error fetching tag ".concat(t,":"),r)}finally{u(!1)}};e()},[t,a]),h)return(0,n.jsx)("div",{className:"animate-pulse ".concat(l),style:{width:s,height:s}});let x=(null==d?void 0:d.icon)||(null==d?void 0:d.name)||o;return(0,n.jsx)(g.Z,{iconName:x,size:s,className:l,defaultIcon:o})},(e,t)=>e.tagId===t.tagId&&e.facet===t.facet&&e.size===t.size&&e.className===t.className&&e.fallbackIcon===t.fallbackIcon),f=a(417),w=e=>{let{expenses:t,isLoading:a}=e,[s,l]=(0,r.useState)({}),[o,i]=(0,r.useState)({}),[c,d]=(0,r.useState)(0),[m,h]=(0,r.useState)([]);return((0,r.useEffect)(()=>{if(!t||0===t.length){h([]),d(0);return}let e=t.reduce((e,t)=>e+t.amount,0);d(e);let a={};t.forEach(e=>{e.area_tags&&e.area_tags.length>0?e.area_tags.forEach(t=>{a[t]||(a[t]={name:t,amount:0,count:0,icon:e.main_tag_icon||t}),a[t].amount+=e.amount,a[t].count+=1}):(a.Other||(a.Other={name:"Other",amount:0,count:0,icon:"HelpCircle"}),a.Other.amount+=e.amount,a.Other.count+=1)});let n=Object.values(a).map(t=>({...t,percentage:Math.round(t.amount/e*100)}));n.sort((e,t)=>t.amount-e.amount),h(n);let r=n.map(e=>({name:e.name,value:e.amount,itemStyle:{color:(0,f.vm)(e.name,"hex")}}));i({tooltip:{trigger:"item",formatter:e=>{let t=n.find(t=>t.name===e.name);return'\n            <div style="padding: 8px;">\n              <div style="font-weight: bold; margin-bottom: 4px;">'.concat(e.name,"</div>\n              <div>Amount: $").concat(e.value.toFixed(2),"</div>\n              <div>Percentage: ").concat(e.percent,"%</div>\n              <div>Expenses: ").concat(t?t.count:0,"</div>\n            </div>\n          ")}},legend:{orient:"vertical",right:10,top:"center",type:"scroll",textStyle:{color:"#666"}},series:[{name:"Expenses by Category",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1},scale:!0,scaleSize:10},labelLine:{show:!1},data:r}]})},[t]),a)?(0,n.jsx)("div",{className:"bg-white rounded-3xl shadow-md p-6 flex items-center justify-center",style:{minHeight:"300px"},children:(0,n.jsx)(x.Z,{})}):t&&0!==t.length?(0,n.jsxs)("div",{className:"bg-white rounded-3xl shadow-md p-6",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Spending by Category"}),(0,n.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Total: $",c.toFixed(2)]}),(0,n.jsx)("div",{className:"h-80",children:(0,n.jsx)(u.Z,{option:o,style:{height:"100%",width:"100%"},opts:{renderer:"canvas"},notMerge:!0,lazyUpdate:!0})}),(0,n.jsx)("div",{className:"mt-4 space-y-3",children:m.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(y,{tagId:e.name.toLowerCase(),facet:"area",size:20,className:"mr-2 text-gray-600",fallbackIcon:"tag",iconCache:s,setIconCache:l}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-500 mr-2",children:["$",e.amount.toFixed(2)]}),(0,n.jsxs)("span",{className:"text-xs font-medium px-2 py-1 rounded-full bg-gray-100 text-gray-600",children:[e.percentage,"%"]})]})]},t))})]}):(0,n.jsxs)("div",{className:"bg-white rounded-3xl shadow-md p-6 flex flex-col items-center justify-center",style:{minHeight:"300px"},children:[(0,n.jsx)(g.Z,{name:"PieChart",className:"w-12 h-12 text-gray-300 mb-4"}),(0,n.jsx)("p",{className:"text-gray-500 text-center",children:"No expense data available for this period"})]})},b=a(4682);function v(){let{user:e}=(0,i.a)(),[t,a]=(0,r.useState)(!0),[s,d]=(0,r.useState)([]),[m,u]=(0,r.useState)([]),[x,g]=(0,r.useState)({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1),endDate:new Date,rangeId:"thisMonth"});return(0,r.useEffect)(()=>{let e=async()=>{a(!0);try{let e=await b.Z.getExpenses();d(e)}catch(e){console.error("Error fetching expenses:",e)}finally{a(!1)}};e()},[]),(0,r.useEffect)(()=>{if(!s.length){u([]);return}let{startDate:e,endDate:t}=x,a=e instanceof Date?e:new Date(e),n=t instanceof Date?t:new Date(t);a.setHours(0,0,0,0),n.setHours(23,59,59,999);let r=s.filter(e=>{let t=new Date(e.timestamp);return t>=a&&t<=n});u(r)},[s,x]),(0,n.jsx)(c.i,{children:(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(l(),{children:(0,n.jsx)("title",{children:"Reports | MoneyManager"})}),(0,n.jsxs)("div",{className:"px-4 py-6 max-w-lg mx-auto",children:[(0,n.jsxs)("header",{className:"mb-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Reports"}),(0,n.jsx)("p",{className:"text-gray-500 mb-4",children:"View your spending analytics"}),(0,n.jsx)(h,{onDateRangeChange:e=>{g(e)}})]}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)(w,{expenses:m,isLoading:t})})]})]})})}},6006:function(e,t,a){"use strict";var n=a(7066),r=a(8346);let s="https://moneymanager-backend-qwbwl7ldoa-oa.a.run.app";console.log("Tag service using API URL:",s);let l=async()=>{let e=(0,r.v0)(),t=e.currentUser;if(!t)throw Error("User not authenticated");return await t.getIdToken()},o=async()=>{let e=await l();return n.Z.create({baseURL:s,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})};t.Z={getAuthToken:l,async getTag(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"area";try{let a=await o(),n=await a.get("/api/tags/".concat(t,"/").concat(e));return n.data}catch(e){throw console.error("Error fetching ".concat(t," tag:"),e),e}},async getTags(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"area";try{let a=await o(),n=e.map(e=>"ids=".concat(e)).join("&"),r=await a.get("/api/tags/".concat(t,"?").concat(n));return r.data}catch(e){throw console.error("Error fetching ".concat(t," tags:"),e),e}},async getAllTags(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"area";try{let t=await o(),a=await t.get("/api/tags/".concat(e));return a.data}catch(t){throw console.error("Error fetching all ".concat(e," tags:"),t),t}}}}},function(e){e.O(0,[976,260,193,187,774,888,179],function(){return e(e.s=8442)}),_N_E=e.O()}]);