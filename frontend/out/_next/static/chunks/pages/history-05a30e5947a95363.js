(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{484:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/history",function(){return a(9539)}])},5493:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(5893),r=a(1664),n=a.n(r),l=a(1163),o=a(2537);function c(e){let{children:t}=e,a=(0,l.useRouter)(),{user:r}=(0,o.a)(),n="/login"===a.pathname||"/"===a.pathname;return n?(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-[#7B3FE4] to-[#9C6EFF]",children:t}):(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,s.jsx)("main",{className:"flex-1 pb-16",children:t}),(0,s.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-100 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"flex justify-around items-center h-16",children:[(0,s.jsx)(i,{href:"/home",icon:"home",active:"/home"===a.pathname}),(0,s.jsx)(i,{href:"/reports",icon:"reports",active:"/reports"===a.pathname}),(0,s.jsx)(i,{href:"/chat",icon:"add",active:"/chat"===a.pathname}),(0,s.jsx)(i,{href:"/history",icon:"history",active:"/history"===a.pathname}),(0,s.jsx)(i,{href:"/profile",icon:"profile",active:"/profile"===a.pathname})]})})]})}function i(e){let{href:t,icon:a,active:r}=e;return"add"===a?(0,s.jsx)(n(),{href:t,className:"flex items-center justify-center p-3",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full shadow-md",style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})}):(0,s.jsx)(n(),{href:t,className:"flex items-center justify-center p-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-center h-10 w-10 rounded-full transition-all duration-300 ".concat(r?"scale-110 shadow-sm":""),style:{background:r?"rgba(124, 58, 237, 0.15)":"transparent"},children:["home"===a&&(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ".concat(r?"text-purple-600":"text-gray-400"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r?2:1.5,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"reports"===a&&(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ".concat(r?"text-purple-600":"text-gray-400"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r?2:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"history"===a&&(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ".concat(r?"text-purple-600":"text-gray-400"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r?2:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"profile"===a&&(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ".concat(r?"text-purple-600":"text-gray-400"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:r?2:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})]})})}},558:function(e,t,a){"use strict";a.d(t,{i:function(){return o}});var s=a(5893),r=a(7294),n=a(1163),l=a(2537);function o(e){let{children:t}=e,{isAuthenticated:a,loading:o}=(0,l.a)(),c=(0,n.useRouter)(),[i,d]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{o||(a()?d(!0):c.push("/login"))},[a,o,c]),o||!i)?(0,s.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50"}):t}},9539:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=a(5893),r=a(7294),n=a(9008),l=a.n(n);a(1664);var o=a(5493),c=a(2537),i=a(558),d=a(4682);let u={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CAD:"C$",AUD:"A$",CHF:"Fr",CNY:"\xa5",INR:"₹",BRL:"R$"},x={food:{icon:"\uD83C\uDF7D️",color:"bg-orange-500"},groceries:{icon:"\uD83D\uDED2",color:"bg-green-500"},restaurant:{icon:"\uD83C\uDF74",color:"bg-orange-400"},shopping:{icon:"\uD83D\uDECD️",color:"bg-purple-500"},entertainment:{icon:"\uD83C\uDFAC",color:"bg-red-500"},travel:{icon:"✈️",color:"bg-blue-500"},transport:{icon:"\uD83D\uDE97",color:"bg-blue-400"},health:{icon:"\uD83D\uDC8A",color:"bg-red-400"},utilities:{icon:"\uD83D\uDCA1",color:"bg-yellow-500"},home:{icon:"\uD83C\uDFE0",color:"bg-teal-500"},personal:{icon:"\uD83D\uDC64",color:"bg-indigo-500"},education:{icon:"\uD83D\uDCDA",color:"bg-blue-600"},gift:{icon:"\uD83C\uDF81",color:"bg-pink-500"},default:{icon:"\uD83D\uDCB0",color:"bg-purple-500"}},h=e=>u[e]||e,g=e=>{if(!e||0===e.length)return x.default;let t=e[0].toLowerCase();return x[t]||x.default},m=e=>{let t=new Date(e),a=t.toLocaleDateString("en-US",{month:"long",day:"numeric"}),s=t.getHours(),r=t.getMinutes().toString().padStart(2,"0");return"".concat(a,", ").concat(s,":").concat(r)};function p(){let{user:e}=(0,c.a)(),[t,a]=(0,r.useState)([]),[n,u]=(0,r.useState)(!0),[x,p]=(0,r.useState)(null),[f,w]=(0,r.useState)({areaTags:[],contextTags:[]}),[y,j]=(0,r.useState)({areaTags:[],contextTags:[]}),[v,b]=(0,r.useState)(null),[N,D]=(0,r.useState)(null),[k,E]=(0,r.useState)(0),T=e=>{let t=new Set,a=new Set;return e.forEach(e=>{Array.isArray(e.area_tags)&&e.area_tags.forEach(e=>t.add(e)),Array.isArray(e.context_tags)&&e.context_tags.forEach(e=>a.add(e))}),{areaTags:[...t],contextTags:[...a]}},C=(e,t)=>{w(a=>{let s=[...a[t]],r=s.indexOf(e);return -1===r?s.push(e):s.splice(r,1),{...a,[t]:s}})};(0,r.useEffect)(()=>{if(!e)return;let t=async()=>{try{u(!0);let e=await d.Z.getExpenses(),t=e.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)),s=t.map((e,t)=>e.id?e:{...e,id:"temp-id-".concat(t)});a(s),j(T(s)),E(s.reduce((e,t)=>e+t.amount,0)),p(null)}catch(e){p("Failed to load expenses. Please try again later.")}finally{u(!1)}};t()},[e]),(0,r.useEffect)(()=>{if(!N)return;let e=setTimeout(()=>D(null),3e3);return()=>clearTimeout(e)},[N]);let _=async()=>{if(v)try{await d.Z.deleteExpense(v.id),a(e=>e.filter(e=>e.id!==v.id)),D({type:"success",message:"Expense deleted successfully"})}catch(e){D({type:"error",message:"Failed to delete expense"})}finally{b(null)}};return(0,s.jsx)(i.i,{children:(0,s.jsxs)(o.Z,{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"Expense History | MoneyManager"})}),(0,s.jsxs)("div",{className:"h-[calc(100vh-64px)] flex flex-col bg-white",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"Expense History"})}),(0,s.jsxs)("div",{className:"space-y-2 mt-4",children:[y.areaTags.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Area Tags"}),(0,s.jsx)("div",{className:"flex overflow-x-auto pb-2 scrollbar-hide",children:(0,s.jsx)("div",{className:"flex space-x-2",children:y.areaTags.map(e=>(0,s.jsx)("button",{onClick:()=>C(e,"areaTags"),className:"flex-shrink-0 px-3 py-1 rounded-full text-xs font-medium ".concat(f.areaTags.includes(e)?"bg-gradient-to-r from-blue-500 to-purple-600 text-white":"bg-blue-100 text-blue-800"),children:e},"area-".concat(e)))})})]}),y.contextTags.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Context Tags"}),(0,s.jsx)("div",{className:"flex overflow-x-auto pb-2 scrollbar-hide",children:(0,s.jsx)("div",{className:"flex space-x-2",children:y.contextTags.map(e=>(0,s.jsx)("button",{onClick:()=>C(e,"contextTags"),className:"flex-shrink-0 px-3 py-1 rounded-full text-xs font-medium ".concat(f.contextTags.includes(e)?"bg-gradient-to-r from-pink-400 to-orange-400 text-white":"bg-orange-100 text-orange-800"),children:e},"context-".concat(e)))})})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:n?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500 animate-bounce",style:{animationDelay:"0ms"}}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500 animate-bounce",style:{animationDelay:"150ms"}}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500 animate-bounce",style:{animationDelay:"300ms"}})]})}):x?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("p",{className:"text-red-500",children:x})}):0===t.length?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCB0"})}),(0,s.jsx)("p",{className:"text-gray-500",children:"No expenses found. Start tracking your expenses in the chat!"})]})}):(0,s.jsx)("div",{className:"space-y-3 max-w-lg mx-auto",children:(f.areaTags.length||f.contextTags.length?t.filter(e=>{let t=!f.areaTags.length||e.area_tags&&f.areaTags.some(t=>e.area_tags.includes(t)),a=!f.contextTags.length||e.context_tags&&f.contextTags.some(t=>e.context_tags.includes(t));return t&&a}):t).map(e=>{let t=g(e.area_tags);return(0,s.jsxs)("div",{className:"bg-white rounded-3xl shadow-md shadow-gray-100/60 p-3 flex items-center justify-between mb-3",onTouchStart:t=>{t.currentTarget.touchTimer=setTimeout(()=>{b({id:e.id})},800)},onTouchEnd:e=>{clearTimeout(e.currentTarget.touchTimer)},onContextMenu:t=>{t.preventDefault(),b({id:e.id})},children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm flex-shrink-0",style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},children:t.icon}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 ml-3",children:[(0,s.jsx)("div",{className:"font-medium text-gray-800 truncate",children:e.short_text||"Expense"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:m(e.timestamp)})]}),(0,s.jsxs)("div",{className:"text-lg font-bold text-gray-800 ml-4",children:[h(e.currency),e.amount.toFixed(2)]})]},e.id)})})}),v&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-3xl p-5 max-w-sm w-full shadow-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Delete Expense?"}),(0,s.jsx)("p",{className:"text-gray-600 mb-5",children:"This will permanently delete this expense from your records."}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>b(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:_,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity",style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},children:"Delete"})]})]})}),N&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:(0,s.jsx)("div",{className:"px-6 py-3 rounded-xl shadow-lg whitespace-nowrap ".concat("success"===N.type?"bg-green-400":"bg-red-400"," text-white font-medium text-center"),children:N.message})})]})]})})}},4682:function(e,t,a){"use strict";var s=a(7066),r=a(8346);let n="https://moneymanager-backend-qwbwl7ldoa-oa.a.run.app";console.log("Expense service using API URL:",n);let l=async()=>{let e=(0,r.v0)(),t=e.currentUser;if(!t)throw Error("User not authenticated");return await t.getIdToken()},o=async()=>{let e=await l();return s.Z.create({baseURL:n,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})};t.Z={getAuthToken:l,async getExpenses(){try{let e=await o(),t=await e.get("/api/expenses/");return t.data}catch(e){throw console.error("Error fetching expenses:",e),e}},async getExpense(e){try{let t=await o(),a=await t.get("/api/expenses/".concat(e));return a.data}catch(e){throw console.error("Error fetching expense:",e),e}},async createExpense(e){try{let t=await o(),a=await t.post("/api/expenses/",e);return a.data}catch(e){throw console.error("Error creating expense:",e),e}},async updateExpense(e,t){try{let a=await o(),s=await a.patch("/api/expenses/".concat(e),t);return s.data}catch(e){throw console.error("Error updating expense:",e),e}},async deleteExpense(e){try{if(console.log("Attempting to delete expense with ID: ".concat(e)),!e)throw Error("No expense ID provided for deletion");let t=await o(),a="".concat(n,"/api/expenses/").concat(e);console.log("Sending DELETE request to: ".concat(a));let s=await t.delete(a);return console.log("Delete response:",s.status,s.statusText),!0}catch(e){throw console.error("Error deleting expense:",e),e}}}}},function(e){e.O(0,[664,66,774,888,179],function(){return e(e.s=484)}),_N_E=e.O()}]);