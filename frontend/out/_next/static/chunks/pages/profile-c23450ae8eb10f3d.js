(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9344:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return r(7060)}])},2062:function(e,t,r){"use strict";var s=r(5893);r(7294);var a=r(7814),n=r(9417),l=r(3636);r(6910),l.vI.add(n.mRB);let c=e=>e?e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z][a-z])/g,"$1-$2").toLowerCase():"";t.Z=e=>{let{iconName:t,size:r,className:n="",defaultIcon:l="tag",style:i={}}=e;console.log("[DynamicIcon] Received iconName:",t);let o=t||l;console.log("[DynamicIcon] iconToRender (original):",o);let d=c(o);console.log("[DynamicIcon] iconToRender (kebab-case):",d);let u={...i};"number"==typeof r?u.fontSize="".concat(r,"px"):"string"!=typeof r||["xs","sm","lg","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(r.toLowerCase())||(u.fontSize=r);try{return(0,s.jsx)(a.G,{icon:d,size:"string"==typeof r&&["xs","sm","lg","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(r.toLowerCase())?r:void 0,className:n,style:u,"aria-label":t||l})}catch(e){console.error('[DynamicIcon] Error rendering icon "'.concat(d,'" (original: "').concat(o,'"):'),e),console.warn('[DynamicIcon] FontAwesome icon "'.concat(d,'" not found or error during render. Falling back to "').concat(c("tag"),'".'));try{return(0,s.jsx)(a.G,{icon:c("tag"),size:"string"==typeof r&&["xs","sm","lg","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(r.toLowerCase())?r:void 0,className:n,style:u,"aria-label":l})}catch(e){return console.error('[DynamicIcon] Error rendering DEFAULT_ICON "'.concat(c("tag"),'":'),e),(0,s.jsx)("span",{"aria-label":l,children:"⚠️"})}}}},5493:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(5893),a=r(1664),n=r.n(a),l=r(1163),c=r(2537),i=r(2062);function o(e){let{children:t}=e,r=(0,l.useRouter)(),{user:a}=(0,c.a)(),n="/login"===r.pathname||"/"===r.pathname;return n?(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-[#7B3FE4] to-[#9C6EFF]",children:t}):(0,s.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,s.jsx)("main",{className:"flex-1 pb-16",children:t}),(0,s.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-100 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"flex justify-around items-center h-16",children:[(0,s.jsx)(d,{href:"/home",icon:"home",active:"/home"===r.pathname}),(0,s.jsx)(d,{href:"/reports",icon:"reports",active:"/reports"===r.pathname}),(0,s.jsx)(d,{href:"/chat",icon:"add",active:"/chat"===r.pathname}),(0,s.jsx)(d,{href:"/history",icon:"history",active:"/history"===r.pathname}),(0,s.jsx)(d,{href:"/profile",icon:"profile",active:"/profile"===r.pathname})]})})]})}function d(e){let{href:t,icon:r,active:a}=e;return"add"===r?(0,s.jsx)(n(),{href:t,className:"flex items-center justify-center p-3",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full shadow-md",style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},children:(0,s.jsx)(i.Z,{iconName:"plus",className:"h-6 w-6 text-white"})})}):(0,s.jsx)(n(),{href:t,className:"flex items-center justify-center p-3",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-10 w-10 rounded-full transition-all duration-300 ".concat(a?"scale-110 shadow-sm":""),style:{background:a?"rgba(124, 58, 237, 0.15)":"transparent"},children:(0,s.jsx)(i.Z,{iconName:(e=>{switch(e){case"home":return"house";case"reports":return"chart-simple";case"history":return"clock-rotate-left";case"profile":return"user";case"add":return"plus";default:return"circle"}})(r),className:"h-5 w-5 ".concat(a?"text-purple-600":"text-gray-400"),style:{fontWeight:a?"bold":"normal"}})})})}},5658:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(5893),a=r(2332),n=r.n(a);function l(e){let{size:t="medium",containerClass:r="",text:a="",fullPage:l=!1,type:c="dots"}=e,i={small:{container:"h-6 py-1.5 px-2.5 rounded-2xl",dot:"w-1.5 h-1.5",icon:"h-8 w-8",text:"text-sm"},medium:{container:"h-8 py-2 px-3 rounded-3xl",dot:"w-2 h-2",icon:"h-12 w-12",text:"text-base"},large:{container:"h-10 py-2.5 px-4 rounded-3xl",dot:"w-2.5 h-2.5",icon:"h-16 w-16",text:"text-lg"}},o=i[t]||i.medium;return(0,s.jsxs)("div",{className:"jsx-6e91c5b2b63165c2 "+((l?"flex flex-col justify-center items-center ".concat(!0===l?"h-full w-full absolute inset-0":l):"")||""),children:["spinner"===c?(0,s.jsx)("div",{className:"inline-block p-4 rounded-full bg-gradient-to-r from-blue-500 to-purple-600",children:(0,s.jsx)("img",{src:"/PiggyLogo.png",alt:"Loading",className:"".concat(o.icon," animate-spin object-contain")})}):(0,s.jsx)("div",{className:"flex justify-center items-center space-x-2 ".concat(o.container," shadow-md relative ").concat(r),style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},children:[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("div",{className:"".concat(o.dot," rounded-full bg-white"),style:{opacity:.8,transform:"translateZ(0)",animation:"wave 0.8s ease-in-out ".concat(.1*t,"s infinite alternate")}},t))}),a&&(0,s.jsx)("p",{className:"jsx-6e91c5b2b63165c2 "+"mt-4 ".concat(o.text," font-medium bg-gradient-to-r from-blue-500 to-purple-600 bg-clip-text text-transparent"),children:a}),(0,s.jsx)(n(),{id:"6e91c5b2b63165c2",children:"@-webkit-keyframes wave{0%{-webkit-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-webkit-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}@-moz-keyframes wave{0%{-moz-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-moz-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}@-o-keyframes wave{0%{-o-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-o-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}@keyframes wave{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px);opacity:.7}100%{-webkit-transform:translatey(-5px);-moz-transform:translatey(-5px);-o-transform:translatey(-5px);transform:translatey(-5px);opacity:1}}"})]})}r(7294)},6909:function(e,t,r){"use strict";var s=r(5893);r(7294);var a=r(7537);t.Z=e=>{let{children:t,pageName:r="this page"}=e;return(0,s.jsx)(a.Z,{fallback:(e,t)=>(0,s.jsx)("div",{className:"min-h-[70vh] flex flex-col items-center justify-center p-6 text-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-8 max-w-md w-full",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Something went wrong"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-6",children:["We're sorry, but an error occurred while loading ",r,". This could be due to a temporary issue or a problem with your connection."]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,s.jsx)("button",{onClick:t,className:"btn-primary",children:"Try Again"}),(0,s.jsx)("button",{onClick:()=>window.location.href="/home",className:"btn-secondary",children:"Go to Home"})]}),!1]})}),children:t})}},558:function(e,t,r){"use strict";r.d(t,{i:function(){return c}});var s=r(5893),a=r(7294),n=r(1163),l=r(2537);function c(e){let{children:t}=e,{isAuthenticated:r,loading:c}=(0,l.a)(),i=(0,n.useRouter)(),[o,d]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{c||(r()?d(!0):i.push("/login"))},[r,c,i]),c||!o)?(0,s.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50"}):t}},8530:function(e,t,r){"use strict";r.d(t,{v:function(){return n}});var s=r(9734),a=r(1710);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{shouldFetch:t=!0,revalidateOnFocus:r=!1,dedupingInterval:n=6e4,...l}=e,{data:c,error:i,mutate:o,isValidating:d}=(0,s.ZP)(t?"/api/users/me":null,async()=>{try{return await a.Z.getUserData()}catch(e){throw console.error("Error fetching user data:",e),e}},{revalidateOnFocus:r,dedupingInterval:n,...l});return{userData:c||{},isLoading:!i&&!c,isValidating:d,isError:i,mutate:o}}},7060:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var s=r(5893),a=r(7294),n=r(9008),l=r.n(n),c=r(1163),i=r(5675),o=r.n(i),d=r(5493),u=r(2537),x=r(558),m=r(1710),h=r(7814),p=r(9417),f=r(6909),g=r(5658),y=r(8530);function j(){var e;let{user:t,logout:r}=(0,u.a)(),n=(0,c.useRouter)(),{userData:i,isLoading:j,isError:b,mutate:w}=(0,y.v)({shouldFetch:!!t,revalidateOnFocus:!0}),[v,N]=(0,a.useState)((null==i?void 0:null===(e=i.budget)||void 0===e?void 0:e.toString())||""),[k,C]=(0,a.useState)((null==i?void 0:i.preferred_currency)||"EUR"),[E,z]=(0,a.useState)(!1),[S,Z]=(0,a.useState)({show:!1,message:"",type:""}),[F,L]=(0,a.useState)(!1),[R,A]=(0,a.useState)(!1);null==i||i.totalExpenses,null==i||i.totalCategories,null==i||i.expenseCount,null==i||i.streak;let U={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CAD:"CA$",AUD:"A$",CHF:"CHF",CNY:"\xa5",INR:"₹"},D=Object.keys(U),_=e=>U[e]||e||"";(0,a.useEffect)(()=>{i&&(i.budget&&N(i.budget.toString()),i.preferred_currency&&C(i.preferred_currency))},[i]);let B=async()=>{try{await r(),n.push("/login")}catch(e){console.error("Failed to logout",e)}},I=async e=>{let t=e.target.value;if(t!==k)try{L(!0),await m.Z.updateUserData({preferred_currency:t}),C(t),w(),Z({show:!0,message:"Currency updated successfully!",type:"success"})}catch(e){console.error("Failed to update currency:",e),Z({show:!0,message:"Failed to update currency.",type:"error"})}finally{L(!1)}},P=async()=>{try{L(!0);let e=""===v?0:parseFloat(v);await m.Z.updateUserData({budget:e}),w(),Z({show:!0,message:"Budget updated successfully!",type:"success"}),z(!1)}catch(e){console.error("Failed to update budget:",e),Z({show:!0,message:"Failed to update budget.",type:"error"})}finally{L(!1)}};return j?(0,s.jsx)(x.i,{children:(0,s.jsx)(d.Z,{children:(0,s.jsx)(g.Z,{})})}):b?(0,s.jsx)(x.i,{children:(0,s.jsx)(f.Z,{children:(0,s.jsx)(d.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsx)("p",{className:"text-red-500",children:"Error loading profile. Please try again later."})})})})}):(0,s.jsx)(x.i,{children:(0,s.jsx)(f.Z,{children:(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"Profile | MoneyManager"})}),(0,s.jsxs)("div",{className:"px-4 py-6 max-w-lg mx-auto",children:[(0,s.jsxs)("header",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Profile"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Manage your account"})]}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"relative h-16 w-16 rounded-full overflow-hidden bg-gray-200 mr-4",children:(null==t?void 0:t.photoURL)&&!R?(0,s.jsx)(o(),{src:t.photoURL,alt:"Profile",layout:"fill",objectFit:"cover",onError:()=>A(!0)}):(0,s.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-purple-100 text-purple-500",children:(0,s.jsx)(h.G,{icon:p.ILF,className:"text-2xl"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-800",children:(null==t?void 0:t.displayName)||"User"}),(0,s.jsx)("p",{className:"text-gray-500",children:null==t?void 0:t.email})]})]})}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 rounded-xl shadow-lg p-6 mb-6 text-white",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-white bg-opacity-20 flex items-center justify-center mr-3",children:(0,s.jsx)(h.G,{icon:p.nmd,className:"text-yellow-300 text-lg"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Premium Account"}),(0,s.jsx)("p",{className:"text-purple-100 text-sm",children:"Active Subscription"})]})]})}),(0,s.jsx)("p",{className:"text-purple-100 text-sm leading-relaxed",children:"Enjoy unlimited expense tracking."})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-6",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-100",children:(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Settings"})}),(0,s.jsxs)("div",{className:"divide-y divide-gray-100",children:[(0,s.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-gray-800",children:"Monthly Budget"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Set your monthly spending limit"})]}),(0,s.jsxs)("button",{onClick:()=>z(!0),className:"text-purple-600 hover:text-purple-800 font-medium flex items-center",children:[(null==i?void 0:i.budget)?"".concat(_(k)).concat(i.budget):"Set Budget",(0,s.jsx)(h.G,{icon:p._tD,className:"ml-2 text-sm"})]})]}),(0,s.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-gray-800",children:"Currency"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Select your preferred currency"})]}),(0,s.jsx)("select",{value:k,onChange:I,className:"border border-gray-300 rounded-md px-3 py-1 bg-white focus:outline-none focus:ring-2 focus:ring-purple-500",disabled:F,children:D.map(e=>(0,s.jsxs)("option",{value:e,children:[e," (",_(e),")"]},e))})]})]})]}),(0,s.jsxs)("button",{onClick:B,className:"w-full py-3 bg-red-500 text-white rounded-lg flex items-center justify-center hover:bg-red-600 transition-colors",children:[(0,s.jsx)(h.G,{icon:p.jLD,className:"mr-2"}),"Logout"]})]}),E&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Set Monthly Budget"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("label",{className:"block text-gray-700 mb-2",htmlFor:"budget",children:["Budget Amount (",_(k),")"]}),(0,s.jsx)("input",{id:"budget",type:"text",value:v,onChange:e=>{let t=e.target.value;(""===t||/^\d*\.?\d*$/.test(t))&&N(t)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter amount"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,s.jsx)("button",{onClick:()=>z(!1),className:"px-4 py-2 rounded-lg text-gray-700 bg-gray-100 hover:bg-gray-200 transition-colors font-medium",disabled:F,children:"Cancel"}),(0,s.jsx)("button",{onClick:P,className:"px-4 py-2 rounded-lg text-white font-medium transition-colors ".concat(!v||F?"bg-gray-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"),disabled:!v||F,children:F?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Budget"})]})]})]})}),S.show&&(0,s.jsx)("div",{className:"fixed top-5 inset-x-0 flex justify-center items-start z-[100] px-4",children:(0,s.jsxs)("div",{className:"rounded-lg shadow-lg p-4 flex items-center text-white text-sm font-medium max-w-md w-full animate-fade-in-down\n                ".concat("success"===S.type?"bg-green-500":"error"===S.type?"bg-red-500":"bg-blue-500"),children:["success"===S.type?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):"error"===S.type?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),S.message]})})]})})})}},1710:function(e,t,r){"use strict";var s=r(7066),a=r(8346);let n="https://moneymanager-backend-qwbwl7ldoa-oa.a.run.app";console.log("User service using API URL:",n);let l=async()=>{let e=(0,a.v0)(),t=e.currentUser;if(t)return await t.getIdToken();let r=localStorage.getItem("token");return r||new Promise((t,r)=>{let s;let a=e.onAuthStateChanged(e=>{s&&clearTimeout(s),a(),e?e.getIdToken().then(t).catch(r):r(Error("User not authenticated"))});s=setTimeout(()=>{a(),r(Error("User not authenticated"))},5e3)})},c=async()=>{let e=await l();return s.Z.create({baseURL:n,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})};t.Z={async getUserData(){try{let e=await c(),t=await e.get("/api/users/me");return t.data}catch(e){throw console.error("Error fetching user data:",e),e}},async updateUserData(e){try{let t=await c(),r=await t.patch("/api/users/me",e);return r.data}catch(e){throw console.error("Error updating user data:",e),e}}}}},function(e){e.O(0,[976,260,843,774,888,179],function(){return e(e.s=9344)}),_N_E=e.O()}]);