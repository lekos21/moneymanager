(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{1373:function(e,t,a){"use strict";a.d(t,{Z:function(){return m}});var s=a(7294);/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:r="",children:l,iconNode:d,...m},u)=>(0,s.createElement)("svg",{ref:u,...c,width:t,height:t,stroke:e,strokeWidth:n?24*Number(a)/Number(t):a,className:i("lucide",r),...!l&&!o(m)&&{"aria-hidden":"true"},...m},[...d.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(l)?l:[l]])),m=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...r},o)=>(0,s.createElement)(d,{ref:o,iconNode:t,className:i(`lucide-${n(l(e))}`,`lucide-${e}`,a),...r}));return a.displayName=l(e),a}},8442:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports",function(){return a(7410)}])},3071:function(e,t,a){"use strict";var s=a(5893),n=a(7294),r=a(2062);t.Z=n.memo(e=>{let{iconName:t,iconColor:a,size:n=24,className:l="",fallbackIcon:i="tag",style:o={}}=e,c={color:a,...o};return(0,s.jsx)(r.Z,{iconName:t||i,size:n,className:l,defaultIcon:i,style:c})},(e,t)=>e.iconName===t.iconName&&e.iconColor===t.iconColor&&e.size===t.size&&e.className===t.className&&e.fallbackIcon===t.fallbackIcon&&JSON.stringify(e.style)===JSON.stringify(t.style))},7410:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var s=a(5893),n=a(7294),r=a(9008),l=a.n(r),i=a(5493),o=a(2537),c=a(558),d=a(1373);let m=(0,d.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var u=e=>{let{onDateRangeChange:t}=e,[a,r]=(0,n.useState)(!1),[l,i]=(0,n.useState)("thisMonth"),[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),h=[{id:"today",label:"Today"},{id:"thisWeek",label:"This Week"},{id:"thisMonth",label:"This Month"},{id:"lastMonth",label:"Last Month"},{id:"last3Months",label:"Last 3 Months"},{id:"thisYear",label:"This Year"},{id:"custom",label:"Custom Range"}],x=e=>{let t,a;let s=new Date;switch(e){case"today":t=new Date(s),a=new Date(s);break;case"thisWeek":(t=new Date(s)).setDate(s.getDate()-s.getDay()),a=new Date(s);break;case"thisMonth":default:t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s);break;case"lastMonth":t=new Date(s.getFullYear(),s.getMonth()-1,1),a=new Date(s.getFullYear(),s.getMonth(),0);break;case"last3Months":t=new Date(s.getFullYear(),s.getMonth()-3,1),a=new Date(s);break;case"thisYear":t=new Date(s.getFullYear(),0,1),a=new Date(s);break;case"custom":t=o?new Date(o):null,a=d?new Date(d):null}return{startDate:t,endDate:a}},g=e=>e?e.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}):"",p=e=>{i(e),r(!1);let{startDate:a,endDate:s}=x(e);t({startDate:a,endDate:s,rangeId:e})};return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>r(!a),className:"flex items-center justify-between w-full px-4 py-2 bg-white rounded-xl shadow-sm border border-gray-100 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m,{className:"w-4 h-4 mr-2 text-gray-500"}),(0,s.jsx)("span",{className:"text-gray-700 font-medium",children:(()=>{if("custom"===l&&o&&d)return"".concat(g(new Date(o))," - ").concat(g(new Date(d)));let e=h.find(e=>e.id===l);return e?e.label:"This Month"})()})]}),(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-500 transition-transform ".concat(a?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),a&&(0,s.jsxs)("div",{className:"absolute z-10 mt-2 w-full bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,s.jsx)("div",{className:"p-2",children:h.map(e=>(0,s.jsx)("button",{onClick:()=>p(e.id),className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ".concat(l===e.id?"bg-gradient-to-r from-blue-400 to-purple-500 text-white":"text-gray-700 hover:bg-gray-100"),children:e.label},e.id))}),"custom"===l&&(0,s.jsxs)("div",{className:"p-3 border-t border-gray-100",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Start Date"}),(0,s.jsx)("input",{type:"date",value:o,onChange:e=>c(e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-200 rounded-lg"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"End Date"}),(0,s.jsx)("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-200 rounded-lg"})]})]}),(0,s.jsx)("button",{onClick:()=>{if(o&&d){let{startDate:e,endDate:a}=x("custom");t({startDate:e,endDate:a,rangeId:"custom"}),r(!1)}},disabled:!o||!d,className:"w-full py-2 text-sm rounded-lg text-center ".concat(o&&d?"bg-gradient-to-r from-blue-400 to-purple-500 text-white":"bg-gray-100 text-gray-400"),children:"Apply Custom Range"})]})]})]})},h=a(6219),x=a(5658),g=a(2062),p=a(3071),f=a(8086),w=e=>{let{expenses:t,isLoading:a}=e,[r,l]=(0,n.useState)({}),[i,o]=(0,n.useState)(0),[c,d]=(0,n.useState)([]),{getTag:m}=(0,f.e0)();return((0,n.useEffect)(()=>{if(!t||0===t.length){d([]),o(0);return}let e=t.reduce((e,t)=>e+t.amount,0);o(e);let a={};t.forEach(e=>{e.area_tags&&e.area_tags.length>0?e.area_tags.forEach(t=>{a[t]||(a[t]={name:t,amount:0,count:0,icon:e.main_tag_icon||t,tagId:e.tag_id}),a[t].amount+=e.amount,a[t].count+=1}):(a.Other||(a.Other={name:"Other",amount:0,count:0,icon:"HelpCircle"}),a.Other.amount+=e.amount,a.Other.count+=1)});let s=Object.values(a).map(t=>({...t,percentage:Math.round(t.amount/e*100)}));s.sort((e,t)=>t.amount-e.amount),d(s);let n=s.map(e=>{var t;let a=e.tagId?m(e.tagId):m(e.name),s=(null==a?void 0:null===(t=a.colors)||void 0===t?void 0:t.hex)||"#d1d5db";return{name:e.name,value:e.amount,itemStyle:{color:s}}});l({tooltip:{trigger:"item",formatter:e=>{let t=s.find(t=>t.name===e.name);return'\n            <div style="padding: 8px;">\n              <div style="font-weight: bold; margin-bottom: 4px;">'.concat(e.name,"</div>\n              <div>Amount: $").concat(e.value.toFixed(2),"</div>\n              <div>Percentage: ").concat(e.percent,"%</div>\n              <div>Expenses: ").concat(t?t.count:0,"</div>\n            </div>\n          ")}},legend:{orient:"vertical",right:10,top:"center",type:"scroll",textStyle:{color:"#666"}},series:[{name:"Expenses by Category",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!0,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1},scale:!0,scaleSize:10},labelLine:{show:!1},data:n}]})},[t,m]),a)?(0,s.jsx)("div",{className:"bg-white rounded-3xl shadow-md p-6 flex items-center justify-center",style:{minHeight:"300px"},children:(0,s.jsx)(x.Z,{})}):t&&0!==t.length?(0,s.jsxs)("div",{className:"bg-white rounded-3xl shadow-md p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Spending by Category"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Total: $",i.toFixed(2)]}),(0,s.jsx)("div",{className:"h-80",children:(0,s.jsx)(h.Z,{option:r,style:{height:"100%",width:"100%"},opts:{renderer:"canvas"},notMerge:!0,lazyUpdate:!0})}),(0,s.jsx)("div",{className:"mt-4 space-y-3",children:c.map((e,t)=>{var a;let n=e.tagId?m(e.tagId):m(e.name),r=(null==n?void 0:null===(a=n.colors)||void 0===a?void 0:a.hex)||"#d1d5db";return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(p.Z,{iconName:(null==n?void 0:n.icon)||"tag",iconColor:r,size:20,className:"mr-2",fallbackIcon:"tag"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 mr-2",children:["$",e.amount.toFixed(2)]}),(0,s.jsxs)("span",{className:"text-xs font-medium px-2 py-1 rounded-full",style:{backgroundColor:"".concat(r,"20"),color:r},children:[e.percentage,"%"]})]})]},t)})})]}):(0,s.jsxs)("div",{className:"bg-white rounded-3xl shadow-md p-6 flex flex-col items-center justify-center",style:{minHeight:"300px"},children:[(0,s.jsx)(g.Z,{name:"PieChart",className:"w-12 h-12 text-gray-300 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 text-center",children:"No expense data available for this period"})]})},y=a(4682);function b(){let{user:e}=(0,o.a)(),[t,a]=(0,n.useState)(!0),[r,d]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[x,g]=(0,n.useState)({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1),endDate:new Date,rangeId:"thisMonth"});return(0,n.useEffect)(()=>{let e=async()=>{a(!0);try{let e=await y.Z.getExpenses();d(e)}catch(e){console.error("Error fetching expenses:",e)}finally{a(!1)}};e()},[]),(0,n.useEffect)(()=>{if(!r.length){h([]);return}let{startDate:e,endDate:t}=x,a=e instanceof Date?e:new Date(e),s=t instanceof Date?t:new Date(t);a.setHours(0,0,0,0),s.setHours(23,59,59,999);let n=r.filter(e=>{let t=new Date(e.timestamp);return t>=a&&t<=s});h(n)},[r,x]),(0,s.jsx)(c.i,{children:(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"Reports | MoneyManager"})}),(0,s.jsxs)("div",{className:"px-4 py-6 max-w-lg mx-auto",children:[(0,s.jsxs)("header",{className:"mb-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Reports"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"View your spending analytics"}),(0,s.jsx)(u,{onDateRangeChange:e=>{g(e)}})]}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(w,{expenses:m,isLoading:t})})]})]})})}}},function(e){e.O(0,[976,260,871,219,848,774,888,179],function(){return e(e.s=8442)}),_N_E=e.O()}]);