"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{2062:function(e,t,a){var r=a(5893);a(7294);var s=a(7814),n=a(9417),o=a(3636);a(6910),o.vI.add(n.mRB);let l=e=>e?e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z][a-z])/g,"$1-$2").toLowerCase():"";t.Z=e=>{let{iconName:t,size:a,className:n="",defaultIcon:o="tag",style:i={}}=e;console.log("[DynamicIcon] Received iconName:",t);let c=t||o;console.log("[DynamicIcon] iconToRender (original):",c);let d=l(c);console.log("[DynamicIcon] iconToRender (kebab-case):",d);let x={...i};"number"==typeof a?x.fontSize="".concat(a,"px"):"string"!=typeof a||["xs","sm","lg","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(a.toLowerCase())||(x.fontSize=a);try{return(0,r.jsx)(s.G,{icon:d,size:"string"==typeof a&&["xs","sm","lg","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(a.toLowerCase())?a:void 0,className:n,style:x,"aria-label":t||o})}catch(e){console.error('[DynamicIcon] Error rendering icon "'.concat(d,'" (original: "').concat(c,'"):'),e),console.warn('[DynamicIcon] FontAwesome icon "'.concat(d,'" not found or error during render. Falling back to "').concat(l("tag"),'".'));try{return(0,r.jsx)(s.G,{icon:l("tag"),size:"string"==typeof a&&["xs","sm","lg","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].includes(a.toLowerCase())?a:void 0,className:n,style:x,"aria-label":o})}catch(e){return console.error('[DynamicIcon] Error rendering DEFAULT_ICON "'.concat(l("tag"),'":'),e),(0,r.jsx)("span",{"aria-label":o,children:"⚠️"})}}}},47:function(e,t,a){a.d(t,{ZP:function(){return D},jK:function(){return _}});var r=a(5893),s=a(7294),n=a(1352),o=a(3742),l=a(2448),i=a(3718),c=a(1526),d=a(3495),x=a(4622),u=a(7764),m=a(8086),g=a(3071);function p(e){let{selectedAreaTags:t=[],selectedContextTags:a=[],onTagsChange:n,showAllTags:o=!1}=e,{tags:l}=(0,m.e0)(),[i,c]=(0,s.useState)(""),[d,x]=(0,s.useState)("area"),g=(0,s.useMemo)(()=>{if(!l||0===l.length)return[];let e=i.toLowerCase();return l.filter(t=>{var a,r,s;return(null===(a=t.tag_id)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(r=t.label)||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(s=t.synonyms)||void 0===s?void 0:s.some(t=>t.toLowerCase().includes(e)))})},[l,i]),p=(0,s.useMemo)(()=>o?g:g.filter(e=>e.facet===d),[g,o,d]),y=e=>{if("area"===e.facet){let r=t.includes(e.tag_id)?t.filter(t=>t!==e.tag_id):[...t,e.tag_id];n({area_tags:r,context_tags:a})}else{let r=a.includes(e.tag_id)?a.filter(t=>t!==e.tag_id):[...a,e.tag_id];n({area_tags:t,context_tags:r})}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,r.jsx)("input",{type:"text",value:i,onChange:e=>c(e.target.value),placeholder:"Search tags...",className:"w-full pl-10 pr-4 py-2 border border-gray-200  rounded-lg focus:outline-none focus:ring-2  focus:ring-purple-500 focus:border-transparent transition-all duration-200"})]}),!o&&(0,r.jsxs)("div",{className:"flex gap-2 p-1 bg-gray-100 rounded-lg",children:[(0,r.jsx)("button",{onClick:()=>x("area"),className:"flex-1 py-2 px-4 rounded-md font-medium transition-all\n                      ".concat("area"===d?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"Categories"}),(0,r.jsx)("button",{onClick:()=>x("context"),className:"flex-1 py-2 px-4 rounded-md font-medium transition-all\n                      ".concat("context"===d?"bg-white text-purple-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:"Context"})]}),(t.length>0||a.length>0)&&(0,r.jsxs)("div",{className:"p-3 bg-purple-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-xs text-purple-600 font-medium mb-2",children:"Selected Tags"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[t.map(e=>{let t=l.find(t=>t.tag_id===e);return t&&(0,r.jsx)(f,{tag:t,onRemove:()=>y(t)},e)}),a.map(e=>{let t=l.find(t=>t.tag_id===e);return t&&(0,r.jsx)(f,{tag:t,onRemove:()=>y(t)},e)})]})]}),(0,r.jsx)("div",{className:"max-h-64 overflow-y-auto rounded-lg border border-gray-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 p-3",children:[p.map(e=>(0,r.jsx)(h,{tag:e,isSelected:"area"===e.facet?t.includes(e.tag_id):a.includes(e.tag_id),onClick:()=>y(e)},e.tag_id)),0===p.length&&(0,r.jsx)("div",{className:"col-span-2 sm:col-span-3 py-8 text-center text-gray-500",children:i?'No tags found for "'.concat(i,'"'):"No tags available"})]})})]})}function h(e){var t,a,s;let{tag:n,isSelected:o,onClick:l}=e,i=(null===(t=n.colors)||void 0===t?void 0:t.bgHex)||"#f3f4f6",c=(null===(a=n.colors)||void 0===a?void 0:a.textHex)||"#374151";return(0,r.jsxs)("button",{onClick:l,className:"flex items-center gap-2 p-2 rounded-lg \n                  border-2 transition-all duration-200\n                  ".concat(o?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300 bg-white"),children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:i},children:(0,r.jsx)(g.Z,{iconName:n.icon||"tag",iconColor:(null===(s=n.colors)||void 0===s?void 0:s.hex)||"#6b7280",size:"sm"})}),(0,r.jsx)("span",{className:"text-sm font-medium truncate",style:{color:o?"var(--color-purple-600)":c},children:n.label||n.tag_id})]})}function f(e){var t,a;let{tag:s,onRemove:o}=e,l=(null===(t=s.colors)||void 0===t?void 0:t.bgHex)||"#f3f4f6";return(0,r.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5  rounded-full text-sm font-medium",style:{backgroundColor:l,color:"#333"},children:[(0,r.jsx)(g.Z,{iconName:s.icon||"tag",iconColor:(null===(a=s.colors)||void 0===a?void 0:a.hex)||"#6b7280",size:"xs"}),(0,r.jsx)("span",{children:s.label||s.tag_id}),(0,r.jsx)("button",{onClick:o,className:"ml-1 hover:opacity-70 transition-opacity","aria-label":"Remove ".concat(s.label||s.tag_id," tag"),children:(0,r.jsx)(n.Z,{className:"w-3 h-3"})})]})}var y=a(4682),v=a(4671),b=a(4856);function w(e){let{expense:t,isOpen:a,onClose:o}=e,{mutate:l}=(0,v.t)(),[i,u]=(0,s.useState)(!1),[m,g]=(0,s.useState)({amount:0,currency:"USD",short_text:"",raw_text:"",area_tags:[],context_tags:[],timestamp:new Date().toISOString()});(0,s.useEffect)(()=>{t&&g({amount:t.amount||0,currency:t.currency||"USD",short_text:t.short_text||"",raw_text:t.raw_text||"",area_tags:t.area_tags||[],context_tags:t.context_tags||[],timestamp:t.timestamp||new Date().toISOString()})},[t]);let h=e=>{let{name:t,value:a}=e.target;g(e=>({...e,[t]:a}))},f=async()=>{if(null==t?void 0:t.id){u(!0);try{await y.Z.updateExpense(t.id,m),l(),o()}catch(e){console.error("Failed to update expense:",e)}finally{u(!1)}}};return(0,r.jsx)(c.M,{children:a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.E.div,{className:"fixed inset-0 bg-black/50 z-[var(--z-index-modal-backdrop)]",variants:{hidden:{opacity:0,backdropFilter:"blur(0px)"},visible:{opacity:1,backdropFilter:"blur(8px)"}},initial:"hidden",animate:"visible",exit:"hidden",onClick:o}),(0,r.jsxs)(d.E.div,{className:"fixed top-[8%] left-[4%] -translate-x-1/2 max-w-md w-[92%] max-h-[80vh] md:max-h-[80vh] bg-white rounded-2xl shadow-2xl  z-[var(--z-index-modal)]  flex flex-col overflow-hidden",variants:{hidden:{opacity:0,scale:.95,y:20},visible:{opacity:1,scale:1,y:0,transition:{type:"spring",damping:25,stiffness:300}},exit:{opacity:0,scale:.95,y:20,transition:{duration:.2}}},initial:"hidden",animate:"visible",exit:"exit",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-[#00e4ff] to-[#4d9fff] text-white px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Edit Expense"}),(0,r.jsx)("button",{onClick:o,className:"w-8 h-8 rounded-full flex items-center justify-center hover:bg-white/20 transition-colors","aria-label":"Close dialog",children:(0,r.jsx)(n.Z,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,r.jsx)("label",{htmlFor:"amount",className:"text-sm font-medium text-gray-700",children:"Amount"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-lg font-semibold text-gray-500",children:(0,b.jK)(m.currency)}),(0,r.jsx)("input",{type:"number",id:"amount",name:"amount",value:m.amount,onChange:e=>{let t=parseFloat(e.target.value)||0;g(e=>({...e,amount:t}))},step:"0.01",min:"0",placeholder:"0.00",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4d9fff]  focus:border-transparent transition-all duration-200 text-gray-900 placeholder-gray-400 text-right"})]})]}),(0,r.jsxs)("div",{className:"w-2/5 space-y-1",children:[(0,r.jsx)("label",{htmlFor:"currency",className:"text-sm font-medium text-gray-700",children:"Currency"}),(0,r.jsxs)("select",{id:"currency",name:"currency",value:m.currency,onChange:h,className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4d9fff]  focus:border-transparent transition-all duration-200 text-gray-900",children:[(0,r.jsx)("option",{value:"USD",children:"USD"}),(0,r.jsx)("option",{value:"EUR",children:"EUR"}),(0,r.jsx)("option",{value:"GBP",children:"GBP"}),(0,r.jsx)("option",{value:"JPY",children:"JPY"}),(0,r.jsx)("option",{value:"CAD",children:"CAD"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{htmlFor:"short_text",className:"text-sm font-medium text-gray-700",children:"Quick Description"}),(0,r.jsx)("input",{type:"text",id:"short_text",name:"short_text",value:m.short_text,onChange:h,placeholder:"e.g., Coffee at Starbucks",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4d9fff]  focus:border-transparent transition-all duration-200 text-gray-900 placeholder-gray-400"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{htmlFor:"raw_text",className:"text-sm font-medium text-gray-700",children:"Full Details (Optional)"}),(0,r.jsx)("textarea",{id:"raw_text",name:"raw_text",value:m.raw_text,onChange:h,placeholder:"Add any additional notes...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4d9fff]  focus:border-transparent transition-all duration-200 text-gray-900 placeholder-gray-400 resize-none",rows:3})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Categories & Tags"}),(0,r.jsx)(p,{selectedAreaTags:m.area_tags,selectedContextTags:m.context_tags,onTagsChange:e=>{let{area_tags:t,context_tags:a}=e;g(e=>({...e,area_tags:t,context_tags:a}))},showAllTags:!0})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{htmlFor:"timestamp",className:"text-sm font-medium text-gray-700",children:"Date & Time"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 border border-gray-200 rounded-lg",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5 text-gray-500"}),(0,r.jsx)("input",{type:"datetime-local",id:"timestamp",name:"timestamp",value:m.timestamp.slice(0,16),onChange:h,className:"flex-1 focus:outline-none"})]})]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 px-4 py-3 flex justify-end gap-3",children:[(0,r.jsx)("button",{onClick:o,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),(0,r.jsx)("button",{onClick:f,disabled:i,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-[#d233e9] to-[#4d9fff] text-white\n                          font-medium hover:from-[#d233e9]/90 hover:to-[#4d9fff]/90 transition-all\n                          duration-200 flex items-center gap-2\n                          ".concat(i?"opacity-70 cursor-not-allowed":""),children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):"Save Changes"})]})]})]})})}var j=a(9108),N=a(799);let C={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CAD:"C$",AUD:"A$",CHF:"Fr",CNY:"\xa5",INR:"₹",BRL:"R$"},_=e=>C[e]||e,E=(0,s.memo)(e=>{let{expense:t,messageId:a,onDelete:c,onEdit:d,fullWidth:x=!1}=e,[u,m]=(0,s.useState)(!1),[p,h]=(0,s.useState)(!1),{tag:f,iconName:v,iconColor:b,bgColor:C,textColor:E,borderColor:D}=(0,N.u)(t),k=async()=>{if(!t.id){console.error("No expense ID found:",t);return}let e=!1;try{await y.Z.deleteExpense(t.id),e=!0}catch(e){console.warn("Expense deletion skipped or failed:",e)}if(a)try{await j.Z.deleteMessage(a)}catch(e){console.error("Failed to delete message:",e),alert("Failed to delete message. Please try again."),m(!1);return}c(e?t.id:null,a),m(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"card ".concat(x?"w-full":"w-full min-w-[320px] max-w-[400px]"," border-2 border-l-4 cursor-pointer hover:shadow-md transition-shadow"),style:{borderLeftColor:D},onClick:e=>{!e.target.closest("button")&&(h(!0),d&&d(t))},children:[(0,r.jsxs)("div",{className:"card-header flex justify-between items-center py-2 px-3 gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-full flex items-center justify-center mr-2",children:(0,r.jsx)(g.Z,{iconName:v,iconColor:b,className:"text-gray-700",fallbackIcon:"tag"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1 max-w-[200px]",children:[(0,r.jsx)("h4",{className:"text-base font-semibold text-gray-800 truncate overflow-hidden text-ellipsis",title:t.short_text||"Expense",children:t.short_text||"Expense"}),(0,r.jsxs)("span",{className:"flex items-center text-xs text-gray-500 space-x-1",children:[(0,r.jsx)("span",{children:new Date(t.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{children:new Date(t.timestamp).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})})]})]})]}),(0,r.jsxs)("div",{className:"font-bold whitespace-nowrap flex-shrink-0",children:[_(t.currency),parseFloat(t.amount).toFixed(2)]})]}),(0,r.jsxs)("div",{className:"card-body px-3 py-2 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[t.area_tags&&t.area_tags.map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{backgroundColor:C||"#EBF5FF",color:E||"#3B82F6"},children:e},"area-".concat(e))),t.context_tags&&t.context_tags.map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold",style:{backgroundColor:C?"".concat(C,"80"):"#F0F7FF",color:E||"#2563EB"},children:e},"context-".concat(e)))]}),u?(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),m(!1)},className:"p-1 text-xs text-gray-600 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",children:(0,r.jsx)(n.Z,{className:"w-3 h-3"})}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),k()},className:"p-1 text-xs text-white rounded-full hover:opacity-90 transition-opacity bg-gradient-secondary",children:(0,r.jsx)(o.Z,{className:"w-3 h-3"})})]}):(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),h(!0)},className:"text-gray-400 hover:text-gray-600 transition-colors p-1","aria-label":"Edit expense",children:(0,r.jsx)(l.Z,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),m(!0)},className:"text-gray-400 hover:text-gray-600 transition-colors p-1","aria-label":"Delete expense",children:(0,r.jsx)(i.Z,{className:"w-4 h-4"})})]})]})]}),(0,r.jsx)(w,{expense:t,isOpen:p,onClose:()=>h(!1)})]})});var D=E},5493:function(e,t,a){a.d(t,{Z:function(){return c}});var r=a(5893),s=a(1664),n=a.n(s),o=a(1163),l=a(2537),i=a(2062);function c(e){let{children:t}=e,a=(0,o.useRouter)(),{user:s}=(0,l.a)(),n="/login"===a.pathname||"/"===a.pathname;return n?(0,r.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-[#7B3FE4] to-[#9C6EFF]",children:t}):(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,r.jsx)("main",{className:"flex-1 pb-16",children:t}),(0,r.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-100 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"flex justify-around items-center h-16",children:[(0,r.jsx)(d,{href:"/home",icon:"home",active:"/home"===a.pathname}),(0,r.jsx)(d,{href:"/reports",icon:"reports",active:"/reports"===a.pathname}),(0,r.jsx)(d,{href:"/chat",icon:"add",active:"/chat"===a.pathname}),(0,r.jsx)(d,{href:"/history",icon:"history",active:"/history"===a.pathname}),(0,r.jsx)(d,{href:"/profile",icon:"profile",active:"/profile"===a.pathname})]})})]})}function d(e){let{href:t,icon:a,active:s}=e;return"add"===a?(0,r.jsx)(n(),{href:t,className:"flex items-center justify-center p-3",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-full shadow-md",style:{background:"linear-gradient(45deg, #42A5F5, #cf8ef9, #fe9169)"},children:(0,r.jsx)(i.Z,{iconName:"plus",className:"h-6 w-6 text-white"})})}):(0,r.jsx)(n(),{href:t,className:"flex items-center justify-center p-3",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-10 w-10 rounded-full transition-all duration-300 ".concat(s?"scale-110 shadow-sm":""),style:{background:s?"rgba(124, 58, 237, 0.15)":"transparent"},children:(0,r.jsx)(i.Z,{iconName:(e=>{switch(e){case"home":return"house";case"reports":return"chart-simple";case"history":return"clock-rotate-left";case"profile":return"user";case"add":return"plus";default:return"circle"}})(a),className:"h-5 w-5 ".concat(s?"text-purple-600":"text-gray-400"),style:{fontWeight:s?"bold":"normal"}})})})}},558:function(e,t,a){a.d(t,{i:function(){return l}});var r=a(5893),s=a(7294),n=a(1163),o=a(2537);function l(e){let{children:t}=e,{isAuthenticated:a,loading:l}=(0,o.a)(),i=(0,n.useRouter)(),[c,d]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{l||(a()?d(!0):i.push("/login"))},[a,l,i]),l||!c)?(0,r.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50"}):t}},3071:function(e,t,a){var r=a(5893),s=a(7294),n=a(2062);t.Z=s.memo(e=>{let{iconName:t,iconColor:a,size:s=24,className:o="",fallbackIcon:l="tag",style:i={}}=e,c={color:a,...i};return(0,r.jsx)(n.Z,{iconName:t||l,size:s,className:o,defaultIcon:l,style:c})},(e,t)=>e.iconName===t.iconName&&e.iconColor===t.iconColor&&e.size===t.size&&e.className===t.className&&e.fallbackIcon===t.fallbackIcon&&JSON.stringify(e.style)===JSON.stringify(t.style))},4671:function(e,t,a){a.d(t,{d:function(){return o},t:function(){return n}});var r=a(9734),s=a(4682);function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{shouldFetch:t=!0,revalidateOnFocus:a=!1,dedupingInterval:n=3e4,...o}=e,{data:l,error:i,mutate:c,isValidating:d}=(0,r.ZP)(t?"/api/expenses/":null,async()=>{try{let e=await s.Z.getExpenses();return[...e].sort((e,t)=>new Date(t.timestamp||t.date)-new Date(e.timestamp||e.date))}catch(e){throw console.error("Error fetching expenses:",e),e}},{revalidateOnFocus:a,dedupingInterval:n,...o});return{expenses:l||[],isLoading:!i&&!l,isValidating:d,isError:i,mutate:c}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new Date,a=t.getMonth(),r=t.getFullYear(),s=new Date;s.setDate(s.getDate()-7);let n=e.filter(e=>{let t=new Date(e.timestamp||e.date);return t.getMonth()===a&&t.getFullYear()===r}),o=e.filter(e=>{let t=new Date(e.timestamp||e.date);return t>=s}),l=n.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),i=o.reduce((e,t)=>e+(parseFloat(t.amount)||0),0),c={},d=new Date(r,a+1,0).getDate();for(let e=1;e<=d;e++){let t=e.toString();c[t]={day:t,amount:0}}n.forEach(e=>{let t=new Date(e.timestamp||e.date),a=t.getDate().toString();c[a]&&(c[a].amount+=parseFloat(e.amount)||0)});let x=Object.values(c).sort((e,t)=>parseInt(e.day)-parseInt(t.day));return{monthlyTotal:l,weeklyTotal:i,monthlyExpenses:n,weeklyExpenses:o,dailyExpenses:x}}},799:function(e,t,a){a.d(t,{e:function(){return n},u:function(){return o}});var r=a(7294),s=a(8086);function n(){let e=(0,s.e0)();return{...e,resolveTag:t=>{if(!t)return null;let{getTag:a}=e;return t.tag_id?a(t.tag_id):t.area_tags&&t.area_tags.length>0?a(t.area_tags[0].toLowerCase()):t.tag?t.tag:null},getTagStyling:t=>{var a,r,s,n;let{getTag:o}=e,l="string"==typeof t?o(t):t;return l?{iconName:l.icon||"tag",iconColor:(null===(a=l.colors)||void 0===a?void 0:a.hex)||"#6b7280",bgColor:(null===(r=l.colors)||void 0===r?void 0:r.bgHex)||"#f3f4f6",textColor:(null===(s=l.colors)||void 0===s?void 0:s.textHex)||"#4b5563",borderColor:(null===(n=l.colors)||void 0===n?void 0:n.hex)||"#d1d5db"}:{iconName:"tag",iconColor:"#6b7280",bgColor:"#f3f4f6",textColor:"#4b5563",borderColor:"#d1d5db"}}}}function o(e){var t;let{resolveTag:a,getTagStyling:s}=n();return(0,r.useMemo)(()=>{let t=a(e),r=s(t);return{tag:t,...r}},[null==e?void 0:e.tag_id,null==e?void 0:null===(t=e.area_tags)||void 0===t?void 0:t.join(","),null==e?void 0:e.tag,a,s])}},9108:function(e,t,a){var r=a(7066),s=a(8346);let n="https://moneymanager-backend-qwbwl7ldoa-oa.a.run.app";console.log("Using API URL:",n);let o=async()=>{let e=(0,s.v0)(),t=e.currentUser;if(!t)throw Error("User not authenticated");return await t.getIdToken()},l=async()=>{let e=await o();return r.Z.create({baseURL:n,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})};t.Z={getAuthToken:o,async getMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let t=await l(),a="/api/chat/messages?limit=".concat(e);console.log("Fetching messages from:",a);let r=await t.get(a);return console.log("Messages fetched successfully"),r.data}catch(e){var t;return console.error("Error fetching messages:",e),console.error("Response details:",null===(t=e.response)||void 0===t?void 0:t.data),console.log("Returning fallback messages"),[{id:"fallback-1",content:"Welcome to Money Manager! The message service is currently experiencing issues. Your previous messages will appear when service is restored.",user_id:"system",timestamp:new Date().toISOString(),message_type:"system"}]}},async sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let r=await l(),s=await r.post("/api/chat/messages",{content:e,message_type:t,expense_data:a});return s.data}catch(e){throw console.error("Error sending message:",e),e}},async deleteMessage(e){try{let t=await l();return await t.delete("/api/chat/messages/".concat(e)),!0}catch(e){throw console.error("Error deleting message:",e),e}},async parseExpense(e){try{let t=await l();console.log("Sending expense parser request:",{text:e,save_to_db:!0});let a=await t.post("/api/agents/expense_parser/",{text:e,save_to_db:!0});return console.log("Expense parser response:",a.data),a.data}catch(e){var t;throw console.error("Error parsing expense:",e),console.error("Error details:",null===(t=e.response)||void 0===t?void 0:t.data),e}}}},4682:function(e,t,a){var r=a(7066),s=a(8346);let n="https://moneymanager-backend-qwbwl7ldoa-oa.a.run.app";console.log("Expense service using API URL:",n);let o=async()=>{let e=(0,s.v0)(),t=e.currentUser;if(!t)throw Error("User not authenticated");return await t.getIdToken()},l=async()=>{let e=await o();return r.Z.create({baseURL:n,headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})};t.Z={getAuthToken:o,async getExpenses(){try{let e=await l();console.log("Sending GET request to /api/expenses/");let t=await e.get("/api/expenses/");console.log("Received response from /api/expenses/:",t.status);let a=Array.isArray(t.data)?t.data:[],r=a.map(e=>({...e,amount:"number"==typeof e.amount?e.amount:parseFloat(e.amount||0),area_tags:Array.isArray(e.area_tags)?e.area_tags:[],context_tags:Array.isArray(e.context_tags)?e.context_tags:[],timestamp:e.timestamp||new Date().toISOString()}));return r}catch(e){return console.error("Error fetching expenses:",e),[]}},async getExpense(e){try{let t=await l(),a=await t.get("/api/expenses/".concat(e));return a.data}catch(e){throw console.error("Error fetching expense:",e),e}},async createExpense(e){try{let t=await l(),a=await t.post("/api/expenses/",e);return a.data}catch(e){throw console.error("Error creating expense:",e),e}},async updateExpense(e,t){try{let a=await l(),r=await a.patch("/api/expenses/".concat(e),t);return r.data}catch(e){throw console.error("Error updating expense:",e),e}},async deleteExpense(e){try{if(console.log("Attempting to delete expense with ID: ".concat(e)),!e)throw Error("No expense ID provided for deletion");let t=await l(),a="".concat(n,"/api/expenses/").concat(e);console.log("Sending DELETE request to: ".concat(a));let r=await t.delete(a);return console.log("Delete response:",r.status,r.statusText),!0}catch(e){throw console.error("Error deleting expense:",e),e}}}},4856:function(e,t,a){a.d(t,{jK:function(){return s}});let r={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CAD:"CA$",AUD:"A$",CHF:"CHF",CNY:"\xa5",INR:"₹"},s=e=>r[e]||e||""}}]);